# Rocky 9.4 ä¸»æœºä¸Šçš„ç›®å½•ç»“æ„å®‰æ’

## ğŸ“‚ æ ‡å‡†ç›®å½•ç»“æ„

å¤åˆ¶ä»¥ä¸‹æ–‡ä»¶åˆ° Rocky 9.4 ä¸»æœºåï¼Œåº”ç»„ç»‡æˆå¦‚ä¸‹ç»“æ„ï¼š

```
~/rclone/                             â† é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ Dockerfile.ci                     â† ä» Windows å¤åˆ¶ï¼ˆå®¹å™¨é•œåƒå®šä¹‰ï¼‰
â”œâ”€â”€ docker-ci-commands.sh             â† ä» Windows å¤åˆ¶ï¼ˆCLI å·¥å…·è„šæœ¬ï¼‰
â”œâ”€â”€ Docker/                           â† æ–°å»ºæ­¤ç›®å½•
â”‚   â”œâ”€â”€ verify-docker-runner.sh       â† ä» Windows å¤åˆ¶ï¼ˆå•ç‹¬éªŒè¯è„šæœ¬ï¼‰
â”‚   â”œâ”€â”€ Docker-Runner-éƒ¨ç½²éªŒè¯æŒ‡å—.md â† ä» Windows å¤åˆ¶ï¼ˆä½¿ç”¨è¯´æ˜ï¼‰
â”‚   â””â”€â”€ ... å…¶ä»–å‚è€ƒæ–‡æ¡£
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ docker-runner-verify.yml  â† ä»é¡¹ç›®ä»“åº“å¤åˆ¶ï¼ˆGitHub Actions å·¥ä½œæµï¼‰
â””â”€â”€ ... é¡¹ç›®å…¶ä»–æ–‡ä»¶
```

---

## ğŸ“‹ å¤åˆ¶æ¸…å•

éœ€è¦ä» Windows å¼€å‘æœºå¤åˆ¶åˆ° Rocky ä¸»æœºï¼ˆåˆ° ~/rclone/ï¼‰ï¼š

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¯´æ˜ |
|--------|---------|------|
| `Dockerfile.ci` | `~/rclone/` | å®¹å™¨é•œåƒå®šä¹‰ |
| `docker-ci-commands.sh` | `~/rclone/` | CLI å·¥å…·è„šæœ¬ |
| `é™„å½•/Docker/verify-docker-runner.sh` | `~/rclone/Docker/` | éªŒè¯è„šæœ¬ |
| `é™„å½•/Docker/Docker-Runner-éƒ¨ç½²éªŒè¯æŒ‡å—.md` | `~/rclone/Docker/` | æ–‡æ¡£ |
| `.github/workflows/docker-runner-verify.yml` | `~/rclone/.github/workflows/` | GitHub Actions å·¥ä½œæµ |

---

## ğŸš€ Rocky ä¸»æœºä¸Šçš„è®¾ç½®æ­¥éª¤

### 1. åˆ›å»ºç›®å½•å¹¶å¤åˆ¶æ–‡ä»¶

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir -p ~/rclone/Docker ~/.github/workflows

# å¤åˆ¶ Dockerfile.ci å’Œ docker-ci-commands.sh åˆ°é¡¹ç›®æ ¹ç›®å½•
cp Dockerfile.ci ~/rclone/
cp docker-ci-commands.sh ~/rclone/
chmod +x ~/rclone/docker-ci-commands.sh

# å¤åˆ¶éªŒè¯è„šæœ¬å’Œæ–‡æ¡£åˆ° Docker å­ç›®å½•
cp verify-docker-runner.sh ~/rclone/Docker/
cp Docker-Runner-éƒ¨ç½²éªŒè¯æŒ‡å—.md ~/rclone/Docker/
chmod +x ~/rclone/Docker/verify-docker-runner.sh

# å¤åˆ¶ GitHub Actions å·¥ä½œæµï¼ˆå¦‚éœ€è¦ï¼‰
cp .github/workflows/docker-runner-verify.yml ~/rclone/.github/workflows/
```

### 2. ç›´æ¥è¿›å…¥é¡¹ç›®ç›®å½•è¿è¡Œè„šæœ¬

```bash
cd ~/rclone

# ç°åœ¨å¯ä»¥ç›´æ¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
./docker-ci-commands.sh build      # æ„å»ºå¹¶éªŒè¯ï¼ˆé›†æˆç¯å¢ƒæ£€æŸ¥ï¼‰
./docker-ci-commands.sh run-make   # è¿è¡Œç¼–è¯‘æµ‹è¯•
./docker-ci-commands.sh verify     # éªŒè¯ç¼–è¯‘ç¯å¢ƒ
```

---

## ğŸ”§ è„šæœ¬å·¥ä½œåŸç†

### ä¿®æ”¹åçš„ `docker-ci-commands.sh build` å‘½ä»¤

ç°åœ¨ `build` å‘½ä»¤è‡ªåŠ¨å®Œæˆä»¥ä¸‹å·¥ä½œï¼ˆç­‰åŒäº verify-docker-runner.shï¼‰ï¼š

1. **ç¬¬ 1 æ­¥**ï¼šç³»ç»Ÿç¯å¢ƒæ£€æŸ¥
   - OS ç±»å‹ã€å†…æ ¸ç‰ˆæœ¬ã€ä¸»æœºåã€ç”¨æˆ·ä¿¡æ¯

2. **ç¬¬ 2 æ­¥**ï¼šDocker ç¯å¢ƒéªŒè¯
   - Docker ç‰ˆæœ¬
   - Docker æœåŠ¡è¿è¡ŒçŠ¶æ€
   - å¯åŠ¨ Dockerï¼ˆå¦‚éœ€è¦ï¼‰

3. **ç¬¬ 3 æ­¥**ï¼šDocker åŠŸèƒ½æµ‹è¯•
   - å®¹å™¨æ‰§è¡Œæµ‹è¯•
   - æ•°æ®å·æŒ‚è½½æµ‹è¯•

4. **ç¬¬ 4 æ­¥**ï¼šç½‘ç»œè¿æ¥æ£€æŸ¥
   - GitHub è¿æ¥æµ‹è¯•

5. **ç¬¬ 5 æ­¥**ï¼šç³»ç»Ÿèµ„æºæ£€æŸ¥  
   - CPU æ ¸å¿ƒæ•°
   - å†…å­˜å®¹é‡
   - ç£ç›˜ä½¿ç”¨ç‡

6. **ç¬¬ 6 æ­¥**ï¼šæ„å»º rclone-ci é•œåƒ
   - ç¼–è¯‘ Dockerfile.ci

7. **ç¬¬ 7 æ­¥**ï¼šé•œåƒéªŒè¯
   - éªŒè¯ gccã€go ç­‰å…³é”®å·¥å…·

---

## âœ… å¿«é€ŸéªŒè¯æµç¨‹

å¤åˆ¶æ–‡ä»¶åï¼Œåªéœ€è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼š

```bash
cd ~/rclone
./docker-ci-commands.sh build
```

è¿™ä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰éªŒè¯å’Œæ„å»ºå·¥ä½œï¼Œè¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

```
â„¹ï¸  å¼€å§‹æ„å»º rclone CI é•œåƒ...

â„¹ï¸  ç¬¬ 1 æ­¥ï¼šç³»ç»Ÿç¯å¢ƒæ£€æŸ¥
  âœ“ æ“ä½œç³»ç»Ÿ: Linux
  âœ“ å†…æ ¸ç‰ˆæœ¬: 5.14.0-284.18.1.el9_2.x86_64
  âœ“ ä¸»æœºå: rocky-ci-runner
  âœ“ å½“å‰ç”¨æˆ·: runner

â„¹ï¸  ç¬¬ 2 æ­¥ï¼šDocker ç¯å¢ƒéªŒè¯
  âœ“ Docker version 29.0.0
  âœ“ Docker æœåŠ¡æ­£åœ¨è¿è¡Œ

... æ›´å¤šéªŒè¯è¾“å‡º ...

âœ… é•œåƒåŠŸèƒ½éªŒè¯é€šè¿‡

âœ… rclone-ci é•œåƒæ„å»ºå®Œæˆï¼

åç»­æ­¥éª¤ï¼š
  1. è¿è¡Œç¼–è¯‘æµ‹è¯•:     ./docker-ci-commands.sh run-make
  2. éªŒè¯ç¯å¢ƒ:         ./docker-ci-commands.sh verify
  3. äº¤äº’å¼å®¹å™¨:       ./docker-ci-commands.sh run
```

---

## ğŸ“– å…¶ä»–å‘½ä»¤å‚è€ƒ

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `./docker-ci-commands.sh build --no-cache` | ä¸ç”¨ç¼“å­˜æ„å»ºï¼ˆæ›´æ…¢ä½†æ›´å…¨æ–°ï¼‰ |
| `./docker-ci-commands.sh run-make` | åœ¨å®¹å™¨ä¸­è¿è¡Œ makeï¼ˆç¼–è¯‘ rcloneï¼‰ |
| `./docker-ci-commands.sh run` | è¿›å…¥å®¹å™¨äº¤äº’å¼ bash |
| `./docker-ci-commands.sh verify` | éªŒè¯ CI ç¯å¢ƒ |
| `./docker-ci-commands.sh images` | æŸ¥çœ‹ rclone-ci é•œåƒä¿¡æ¯ |
| `./docker-ci-commands.sh setup` | å®‰è£… Dockerï¼ˆé¦–æ¬¡éƒ¨ç½²æ—¶ï¼‰ |
| `./docker-ci-commands.sh setup-mirrors` | é…ç½®é•œåƒæº |

---

## ğŸ’¡ æç¤º

- **å¦‚æœæ˜¯é¦–æ¬¡éƒ¨ç½²** Rocky 9.4 ä¸»æœºï¼ŒDocker å¯èƒ½ä¸å­˜åœ¨
  ```bash
  cd Docker
  ./docker-ci-commands.sh setup    # å®‰è£… Docker
  # ç„¶åå›åˆ°æ ¹ç›®å½•
  cd ..
  ./docker-ci-commands.sh build
  ```

- **å¦‚æœç½‘ç»œè¾ƒæ…¢**ï¼Œå¯ä»¥æŒ‰æ­¥éª¤æ‰§è¡Œï¼š
  ```bash
  ./docker-ci-commands.sh setup-mirrors  # å…ˆé…ç½®åŠ é€Ÿé•œåƒ
  ./docker-ci-commands.sh build          # å†æ„å»º
  ```

- **å•ç‹¬çš„éªŒè¯è„šæœ¬ä»å¯ç”¨**
  ```bash
  bash Docker/verify-docker-runner.sh     # å¦‚éœ€å•ç‹¬è¯Šæ–­
  ```

---

**ç‰ˆæœ¬**: 2.0ï¼ˆ2026-02-21ï¼‰  
**é€‚ç”¨ç³»ç»Ÿ**: Rocky 9.4+  
**Docker ç‰ˆæœ¬**: 29.x+
